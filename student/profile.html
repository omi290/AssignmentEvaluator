<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Assignment Evaluator</title>
    <link rel="stylesheet" href="../css/style.css">
</head>

<body>
    <!-- Page Loader -->
    <div id="page-loader">
        <div class="loader-letter">
            <svg viewBox="0 0 100 120" xmlns="http://www.w3.org/2000/svg">
                <path d="M 15,100 C 20,60 35,20 50,10 C 65,20 80,60 85,100 M 25,65 Q 50,55 75,65" />
            </svg>
        </div>
        <div class="loader-dots">
            <span></span><span></span><span></span>
        </div>
    </div>

    <div class="portal-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">üìö AES Student</div>
            </div>
            <nav class="sidebar-nav">
                <a href="dashboard.html" class="nav-item">
                    <span class="nav-icon">üìä</span>
                    <span>Dashboard</span>
                </a>
                <a href="assignments.html" class="nav-item">
                    <span class="nav-icon">üìù</span>
                    <span>Assignments</span>
                </a>
                <a href="results.html" class="nav-item">
                    <span class="nav-icon">üéØ</span>
                    <span>Results</span>
                </a>
                <a href="profile.html" class="nav-item active">
                    <span class="nav-icon">üë§</span>
                    <span>Profile</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Navbar -->
            <nav class="navbar">
                <h2 class="navbar-title">Profile</h2>
                <div class="navbar-right">
                    <div class="user-info">
                        <span class="user-avatar" id="navAvatar"
                            style="width: 40px; height: 40px; border-radius: 50%; background: var(--primary-blue); color: white; display: inline-flex; align-items: center; justify-content: center; font-weight: 600;">--</span>
                        <span class="user-name" id="navUserName">Student</span>
                    </div>
                    <a href="../index.html" class="btn btn-sm btn-secondary">Logout</a>
                </div>
            </nav>

            <!-- Content Area -->
            <div class="content-area">
                <div class="page-header">
                    <h1 class="page-title">Student Profile</h1>
                    <p class="page-subtitle">View and manage your profile information</p>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: var(--spacing-lg);">
                    <!-- Profile Card -->
                    <div class="card">
                        <div class="card-body text-center">
                            <span id="profileAvatar"
                                style="width: 120px; height: 120px; border-radius: 50%; background: var(--primary-blue); color: white; margin: 0 auto var(--spacing-md); display: inline-flex; align-items: center; justify-content: center; font-size: 2.5rem; font-weight: 600;">?</span>
                            <h3 style="margin-bottom: var(--spacing-xs);" id="profileName">‚Äî</h3>
                            <p style="color: var(--text-medium); margin-bottom: var(--spacing-md);">Student</p>
                            <span class="badge badge-success">Active</span>
                        </div>
                    </div>

                    <!-- Profile Details -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Personal Information</h3>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; gap: var(--spacing-md);">
                                <div>
                                    <label
                                        style="font-weight: 600; color: var(--text-medium); display: block; margin-bottom: var(--spacing-xs);">
                                        Full Name
                                    </label>
                                    <p style="color: var(--text-dark); font-size: 1.125rem;" id="profileFullName">‚Äî</p>
                                </div>

                                <div>
                                    <label
                                        style="font-weight: 600; color: var(--text-medium); display: block; margin-bottom: var(--spacing-xs);">
                                        Student ID
                                    </label>
                                    <p style="color: var(--text-dark); font-size: 1.125rem;" id="profileStudentId">‚Äî</p>
                                </div>

                                <div>
                                    <label
                                        style="font-weight: 600; color: var(--text-medium); display: block; margin-bottom: var(--spacing-xs);">
                                        Email Address
                                    </label>
                                    <p style="color: var(--text-dark); font-size: 1.125rem;" id="profileEmail">‚Äî</p>
                                </div>

                                <div>
                                    <label
                                        style="font-weight: 600; color: var(--text-medium); display: block; margin-bottom: var(--spacing-xs);">
                                        Department
                                    </label>
                                    <p style="color: var(--text-dark); font-size: 1.125rem;">Computer Science &
                                        Engineering</p>
                                </div>

                                <div>
                                    <label
                                        style="font-weight: 600; color: var(--text-medium); display: block; margin-bottom: var(--spacing-xs);">
                                        Year
                                    </label>
                                    <p style="color: var(--text-dark); font-size: 1.125rem;">3rd Year</p>
                                </div>

                                <div>
                                    <label
                                        style="font-weight: 600; color: var(--text-medium); display: block; margin-bottom: var(--spacing-xs);">
                                        Enrollment Date
                                    </label>
                                    <p style="color: var(--text-dark); font-size: 1.125rem;">August 2023</p>
                                </div>
                            </div>

                            <div class="mt-4"
                                style="padding-top: var(--spacing-md); border-top: 1px solid var(--bg-grey);">
                                <a href="../change-password.html" class="btn btn-primary">
                                    üîí Change Password
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Academic / Assignment Stats (from API) -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h3 class="card-title">Assignment Overview</h3>
                    </div>
                    <div class="card-body">
                        <div class="stats-grid" id="profileStats">
                            <div class="stat-card">
                                <div class="stat-label">Total Assignments</div>
                                <div class="stat-value" id="statTotal">0</div>
                                <div class="stat-change">From your courses</div>
                            </div>
                            <div class="stat-card success">
                                <div class="stat-label">Submitted</div>
                                <div class="stat-value" id="statSubmitted">0</div>
                                <div class="stat-change">Completed</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Evaluated</div>
                                <div class="stat-value" id="statEvaluated">0</div>
                                <div class="stat-change">Graded</div>
                            </div>
                            <div class="stat-card warning">
                                <div class="stat-label">Pending</div>
                                <div class="stat-value" id="statPending">0</div>
                                <div class="stat-change">To submit</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        (function () {
            var name = sessionStorage.getItem("userName") || sessionStorage.getItem("userId") || "Student";
            var id = sessionStorage.getItem("userId");
            document.getElementById("navUserName").textContent = name;
            var av = document.getElementById("navAvatar");
            av.textContent = name.charAt(0).toUpperCase();
            document.getElementById("profileName").textContent = name;
            document.getElementById("profileFullName").textContent = name;
            document.getElementById("profileStudentId").textContent = id || "‚Äî";
            document.getElementById("profileAvatar").textContent = name.charAt(0).toUpperCase();
            if (id) {
                fetch("http://localhost:5000/student/" + encodeURIComponent(id) + "/profile")
                    .then(function (r) { return r.json(); })
                    .then(function (d) {
                        if (d.success) {
                            if (d.name) {
                                document.getElementById("navUserName").textContent = d.name;
                                document.getElementById("profileName").textContent = d.name;
                                document.getElementById("profileFullName").textContent = d.name;
                                document.getElementById("profileAvatar").textContent = d.name.charAt(0).toUpperCase();
                            }
                            document.getElementById("profileEmail").textContent = d.email != null ? d.email : "‚Äî";
                        }
                    })
                    .catch(function () { });
                fetch("http://localhost:5000/student/" + encodeURIComponent(id) + "/dashboard")
                    .then(function (r) { return r.json(); })
                    .then(function (d) {
                        if (d.success) {
                            document.getElementById("statTotal").textContent = d.total_assignments != null ? d.total_assignments : 0;
                            document.getElementById("statSubmitted").textContent = d.submitted_count != null ? d.submitted_count : 0;
                            document.getElementById("statEvaluated").textContent = d.evaluated_count != null ? d.evaluated_count : 0;
                            document.getElementById("statPending").textContent = d.pending_count != null ? d.pending_count : 0;
                        }
                    })
                    .catch(function () { });
            }
        })();
    </script>
    <script>function hideLoader() { var l = document.getElementById('page-loader'); if (l) setTimeout(function () { l.classList.add('hide'); }, 200); } window.addEventListener('load', function () { hideLoader(); });</script>
</body>

</html>