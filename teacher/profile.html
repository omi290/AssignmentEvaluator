<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Profile - Assignment Evaluator</title>
    <link rel="stylesheet" href="../css/style.css">
</head>

<body>
    <div class="portal-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">üë©‚Äçüè´ AES Teacher</div>
            </div>
            <nav class="sidebar-nav">
                <a href="dashboard.html" class="nav-item">
                    <span class="nav-icon">üìä</span>
                    <span>Dashboard</span>
                </a>
                <a href="create-assignment.html" class="nav-item">
                    <span class="nav-icon">‚ûï</span>
                    <span>Create Assignment</span>
                </a>
                <a href="submissions.html" class="nav-item">
                    <span class="nav-icon">üì•</span>
                    <span>Submissions</span>
                </a>
                <a href="profile.html" class="nav-item active">
                    <span class="nav-icon">üë§</span>
                    <span>Profile</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Navbar -->
            <nav class="navbar">
                <h2 class="navbar-title">Profile</h2>
                <div class="navbar-right">
                    <div class="user-info">
                        <span class="user-avatar" id="navAvatar" style="width: 40px; height: 40px; border-radius: 50%; background: var(--primary-blue); color: white; display: inline-flex; align-items: center; justify-content: center; font-weight: 600;">--</span>
                        <span class="user-name" id="navUserName">Teacher</span>
                    </div>
                    <a href="../index.html" class="btn btn-sm btn-secondary">Logout</a>
                </div>
            </nav>

            <!-- Content Area -->
            <div class="content-area">
                <div class="page-header">
                    <h1 class="page-title">Teacher Profile</h1>
                    <p class="page-subtitle">View and manage your profile information</p>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: var(--spacing-lg);">
                    <!-- Profile Card (dynamic) -->
                    <div class="card">
                        <div class="card-body text-center">
                            <span id="profileAvatar" style="width: 120px; height: 120px; border-radius: 50%; background: var(--primary-blue); color: white; margin: 0 auto var(--spacing-md); display: inline-flex; align-items: center; justify-content: center; font-size: 2.5rem; font-weight: 600;">?</span>
                            <h3 style="margin-bottom: var(--spacing-xs);" id="profileName">‚Äî</h3>
                            <p style="color: var(--text-medium); margin-bottom: var(--spacing-md);">Teacher</p>
                            <span class="badge badge-success">Active</span>
                        </div>
                    </div>

                    <!-- Profile Details (dynamic) -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Personal Information</h3>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; gap: var(--spacing-md);">
                                <div>
                                    <label style="font-weight: 600; color: var(--text-medium); display: block; margin-bottom: var(--spacing-xs);">Full Name</label>
                                    <p style="color: var(--text-dark); font-size: 1.125rem;" id="profileFullName">‚Äî</p>
                                </div>
                                <div>
                                    <label style="font-weight: 600; color: var(--text-medium); display: block; margin-bottom: var(--spacing-xs);">Employee ID</label>
                                    <p style="color: var(--text-dark); font-size: 1.125rem;" id="profileTeacherId">‚Äî</p>
                                </div>
                                <div>
                                    <label style="font-weight: 600; color: var(--text-medium); display: block; margin-bottom: var(--spacing-xs);">Email Address</label>
                                    <p style="color: var(--text-dark); font-size: 1.125rem;" id="profileEmail">‚Äî</p>
                                </div>
                            </div>
                            <div class="mt-4" style="padding-top: var(--spacing-md); border-top: 1px solid var(--bg-grey);">
                                <a href="../change-password.html" class="btn btn-primary">üîí Change Password</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Teaching Statistics (from API) -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h3 class="card-title">Teaching Statistics</h3>
                    </div>
                    <div class="card-body">
                        <div class="stats-grid">
                            <div class="stat-card success">
                                <div class="stat-label">Assignments Created</div>
                                <div class="stat-value" id="statAssignments">0</div>
                                <div class="stat-change">Active</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Submissions Received</div>
                                <div class="stat-value" id="statSubmissions">0</div>
                                <div class="stat-change">All time</div>
                            </div>
                            <div class="stat-card warning">
                                <div class="stat-label">Pending Evaluation</div>
                                <div class="stat-value" id="statPending">0</div>
                                <div class="stat-change">Needs attention</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Evaluated</div>
                                <div class="stat-value" id="statEvaluated">0</div>
                                <div class="stat-change">Graded</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
(function(){
    var API_URL = "http://localhost:5000";
    var teacherId = sessionStorage.getItem("userId");
    var n = sessionStorage.getItem("userName") || teacherId || "Teacher";
    document.getElementById("navUserName").textContent = n;
    document.getElementById("navAvatar").textContent = (n && n.charAt(0).toUpperCase()) || "?";
    document.getElementById("profileName").textContent = n;
    document.getElementById("profileFullName").textContent = n;
    document.getElementById("profileTeacherId").textContent = teacherId || "‚Äî";
    document.getElementById("profileAvatar").textContent = (n && n.charAt(0).toUpperCase()) || "?";
    if (teacherId) {
        fetch(API_URL + "/teacher/" + encodeURIComponent(teacherId) + "/profile")
            .then(function(r){ return r.json(); })
            .then(function(d){
                if (d.success) {
                    if (d.name) {
                        document.getElementById("navUserName").textContent = d.name;
                        document.getElementById("profileName").textContent = d.name;
                        document.getElementById("profileFullName").textContent = d.name;
                        document.getElementById("profileAvatar").textContent = d.name.charAt(0).toUpperCase();
                    }
                    document.getElementById("profileEmail").textContent = d.email != null ? d.email : "‚Äî";
                }
            })
            .catch(function(){});
        fetch(API_URL + "/teacher/" + encodeURIComponent(teacherId) + "/dashboard")
            .then(function(r){ return r.json(); })
            .then(function(d){
                if (d.success) {
                    document.getElementById("statAssignments").textContent = d.total_assignments != null ? d.total_assignments : 0;
                    document.getElementById("statSubmissions").textContent = d.submissions_received != null ? d.submissions_received : 0;
                    document.getElementById("statPending").textContent = d.pending_evaluation != null ? d.pending_evaluation : 0;
                    document.getElementById("statEvaluated").textContent = d.evaluated_count != null ? d.evaluated_count : 0;
                }
            })
            .catch(function(){});
    }
})();
</script>
</html>